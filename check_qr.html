<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QRコードチェック</title>
  <link rel="stylesheet" href="css/check_qr.css" />
  <script src="js/html5-qrcode.min.js"></script>
  <script src="js/check_qr.js" defer></script>
</head>
<body>
  <h1>QRコードスキャン</h1>
  <div class="container">
    <section>
      <div id="preview" style="width: 100%; max-width: 400px; margin: 0 auto 20px;"></div>
      <label for="qrResult">読み取り結果</label>
      <input type="text" id="qrResult" placeholder="QRコードの内容がここに表示されます" readonly />
    </section>
  </div>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    const html5QrCode = new Html5Qrcode("preview");
    const qrCodeSuccessCallback = (decodedText, decodedResult) => {
      document.getElementById("qrResult").value = decodedText;
      html5QrCode.stop().catch(err => console.error("停止エラー:", err));
    };
    const config = { fps: 10, qrbox: 250 };
    Html5Qrcode.getCameras().then(devices => {
      if (devices && devices.length) {
        const cameraId = devices[0].id;
        html5QrCode.start(cameraId, config, qrCodeSuccessCallback);
      } else {
        alert("カメラが見つかりませんでした。");
      }
    }).catch(err => console.error("カメラ取得エラー:", err));
  });
</script>
</body>
</html>